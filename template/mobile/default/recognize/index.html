
<include file="public/header" title="亚富链"/>
<include file="public/header_nav" title="亚富链"  href="javascript:history.go(-1);"/>
<style>
	html, body {
		height: 100%;
		width: 100%;
		margin: 0;
		overflow: hidden;
	}
	#site-landing {
		position:relative;
		height: 100%;
		width: 100%;
	   background-image: linear-gradient(to top, #060606 0%, #03a3df 100%);
	}
	#particles{
		height: 100%;
		width: 100%;
		position: absolute;
		top: 1.8rem;
		left: 0;
		right: 0;
		bottom: 0;
		background: url(__STATIC__/images/003.jpg) no-repeat 0 0 /100% 100%;
	}
	 #particles .xintao {
	  width: 100%;
	  height: 100%;
	  padding-top: 10px;
	  position: relative;
	}
	
	.xintao .tip{
		color: #fff;
		font-size: .5rem;
		text-align: center;
		margin: .5rem 0;
	}
	.xintao .flex{
		display: flex;
		flex-direction: column;
		justify-content: space-around;
		align-items: center;
		position: relative;
	}

	.img-box{
		padding: .5rem;
		background-color: #333;
		display: inline-block;
		border-radius: 50%;
		margin: .5rem;
	}
	.xintao .right{
		width: 100%;
		display: flex;
		justify-content: space-between;
		font-size: .5rem;
		align-items: center;
		margin-top: .6rem;
	}
	.xintao .right a{
		color: #fff;
	}
	.xintao .right .link{
		margin-top: .5rem;
		display: flex;
		flex-direction: column;
		justify-content: space-around;
		align-items: flex-end;
	}
	.xintao .links{
		display: block;
		height: 1.5rem;
		display: flex;
		justify-content: space-between;
		align-items: center;
	}
	.xintao  .introduce{
		color: #fff;
		position: absolute;
		padding: .2rem .6rem;
		box-shadow: 3px 0 5px #333 ,0 3px 5px #333,-3px 0 5px #333,0 -3px 5px #333;
		background: #000;
		border-radius: .2rem;
	}
	.xintao .goumai{
		left: -.26rem;
	}
	.xintao .jieshao{
		right: -.26rem;
	}
	.xintao  .balance{
		margin-top: .5rem;
		display: flex;
		align-items: center;
		justify-content: center;
		color: #fff;
		font-size: .5rem;
		flex-direction: column;
		padding-bottom: .8rem;
	}
	.xintao .title{
		font-size: .6rem;
	}
	.xintao  .progress{
		width: 60%;
		height: .5rem;
		border-radius: .3rem;
		background:rgba(241, 173, 70, .6);
		margin-top: .5rem;
	}
	.xintao  .progress .inner{
		width: {$remainRatio}%;
		height: .4rem;
		background-color: #f1ad46;
		/* background-color: #2a81f4; */
		border-radius: .3rem;
		margin-top: .05rem;
		margin-left: .1rem;
	}
	.xintao .joinIn{
		/* border: .1rem solid #00fdfd; */
		background: linear-gradient(to bottom, #f1ad46 , #b36c00);
		padding: .5rem 1.6rem;
		font-weight: bold;
		font-size: .66rem;
		letter-spacing: .1rem;
		color: #fff;
		height: 1.6rem;
	}
	
	.fb{
		position: fixed;
		bottom: 0;
		left: 0;
		right: 0;
		width: 100%;
		height: 1.6rem;
		display: flex;
		align-items: center;
		justify-content: space-between;
	}
	.daojishi{
		font-size: .5rem;
		color: #fff;
		margin-left: .2rem;
		box-shadow: 3px 0 5px #333, 0 3px 5px #333, -3px 0 5px #333, 0 -3px 5px #333; 
		 background-color: #000;
		 height: 1.2rem;
		 line-height: 1.2rem;
		 padding: 0 .4rem ;
		
	}
	.daojishi .time{
		margin-top: .5rem;
		font-size: .5rem;
		margin-left: .2rem;
	}
	.success{
		font-size: .6rem;
		color: #fff;
		margin-top: 1.5rem;
		width: 100%;
	}
	.success ul{
		height: 7rem;
		width: 80%;
		margin:  0 auto;
		box-shadow: 3px 0 5px #333 ,0 3px 5px #333,-3px 0 5px #333,0 -3px 5px #333;
		overflow: hidden;
		background: #2b2b2b;
	}
	.success .flex-box{
		display: flex;
		flex-direction: row;
		align-items: center;
		padding-left: .5rem;
		height: 1rem;
		justify-content: center;
		font-size: .5rem;
	}
	.mask {
	    position: fixed;
	    bottom: 0;
	    left: 0;
	    width: 100%;
	    height: 100%;
	    text-align: center;
	    background: rgba(0,0,0,0.6);
	    z-index: 9;
	}
	.hide {
	    display: none;
	}
	.chain .chainBox {
	    width: 85%;
	    height: 30%;
	    position: absolute;
	    top: 25%;
	    left: 50%;
	    z-index: 1000;
	   transform: translateX(-50%)
	}
	.chain .chainBox .chainText {
	    color: black;
	    background-color: #fff;
	    border: .2rem solid #30cfd0;
	    border-radius: .5rem;
	    padding:0  2%;
	    text-align: center;
	    height: 100%;
	}
	.chainText h1 {
	    color: #2A81F4;
	    font-size:.66rem;
	    padding-bottom: .6rem;
	    border-bottom: 1px solid #2A81F4;
		padding-top: .3rem;
	}

	.chainText h2 {
	    /* padding: 4% 0; */
	    font-weight: normal;
	    font-size: .5rem;
	    margin-bottom: .5rem;
	}
	.chainText .input {
	    margin-bottom: .5rem;
	    width: 100%;
	    justify-content: center;
	    margin-top: 1rem;
	}
	.chainBox .chainText .input span {
	    display: inline-block;
	    width: 1rem;
	    height: 1rem;
	    margin: 0 .3rem;
	}
	.chainText .input .cut {
	    background: url(__STATIC__/images/ico/ico_chain_cut1.png) no-repeat center center;
	    background-size: 100% 100%;
	}
	.flex-box {
	    display: -webkit-box;
	    display: -webkit-flex;
	    display: flex;
	    -webkit-box-align: center;
	    -webkit-align-items: center;
	    align-items: center;
	}
	.chainText .input input {
	    -webkit-appearance: none;
	    appearance: none;
	    outline: none;
	    text-decoration: none;
	    border: 1px solid #757575;
	    border-radius: .3rem;
	    width: 75%;
	    height: 1.3rem;
	    text-align: center;
	    font-size: .6rem;
	}
	 .chainText .input .add {
	    background: url(__STATIC__/images/ico/ico_chain_add1.png) no-repeat center center;
	    background-size: 100% 100%;
	}
	.chainBox .chainText p.pricemoney {
	    font-size: .55rem;
	    color: #2A81F4;
	    justify-content: center;
	    margin-top: .8rem;
	}
	.chain .chainBox .btn {
	    width: 70%;
	    height: 2.4rem;
	    background: url(__STATIC__/images/ico/ico_chain_btn.png) no-repeat center center;
	    background-size: 100% 100%;
	    margin: 5% auto 0;
	    font-size: 1rem;
	}
	.rc_box{
		display: flex;
		justify-content: space-between;
	}
	.rc_bb{
		padding: .8rem;

	}
	.rc_box .rc_logo{
		margin-right: .5rem;
		background-color: #f1ad46;
		border-top-left-radius: .2rem;
		border-top-right-radius: .2rem;
		height: 5rem;
	}
	.rc_box .rc_logo img{
		width: 3rem;
		height: 3rem;
	}
	.rc_box .rc_info{
		flex: 1;
		background-color: #f1ad46;
		height: 4.5rem;
		border-radius: .2rem;
		display: flex;
		flex-direction: column;
		justify-content: space-around;
		color: #fff;
		padding-left: .2rem;
	}
	.xintao .rc_tt{
		background-color: #f1ad46;
		height: 1.5rem;
		border-bottom-left-radius: .2rem;
		border-bottom-right-radius: .2rem;
		border-top-right-radius: .2rem;
	}
	.xintao .rc_tt p{
		color: #fff;
		font-size: .6rem;
		text-align: center;
		line-height: 1.5rem;
	}
</style>	

	<div id="particles">
	    <div class="xintao">
			<div class="rc_bb">
				<div class="rc_box">
					<div class="rc_logo">
						<div class="img-box">
								<img src="__STATIC__/images/ico/0.png" alt="">	
						</div>
					</div>
					<div class="rc_info">
						<p>认筹单价：{$recognize.price}元GB</p>
						<p>认筹总量：3亿GB</p>
						<p>剩余能量：{$recognize.remain_qty}GB</p>
					</div>
				</div>
				<div class="rc_tt">
					<p>标题</p>
				</div>
			</div>

			<div class="balance" href="javascript:;">
				<div class="title">众筹能量剩余{$remainRatio}%</div>						
				<div class="progress"><div class="inner"></div></div>
			</div>

			<div class="links">
					<a class="introduce jieshao" href="javascript:;">认筹介绍</a>
					<a class="introduce goumai" href="{:U('Recognize/buyhistory')}">购买记录</a>
			</div>
			 <div class="flex">
				
				<div class=" success">
					<ul>
						<empty name="buyList">
							<div class="data_none">
								<img src="__STATIC__/images/ico/none_data.png" alt="">
								<p>还没有数据呢！</p>
							</div>
						<else/>
							<foreach name="buyList" id="buy">
								<li class="flex-box">
									恭喜<span>会员{$buy.safe_mobile}</span>成功购买
									<span>{$buy.buy_qty}</span>GB算能
								</li>
							</foreach>
						</empty>
					</ul>	
				</div>
				<!-- <div class="success">
						<ul>
							<foreach name="buyList" id="buy">
								<li class="flex-box">
									恭喜<span>会员{$buy.safe_mobile}</span>成功购买
									<span>{$buy.buy_qty}</span>GB亚富链
								</li>
							</foreach>
						</ul>
					</div> -->
			 </div>
	     	
			<div class="fb">
				<div class="daojishi">
					<span>倒计时</span>
					<span class="time">
							&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;天&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;时&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;分&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;秒
					</span>
				</div>
				<a href="javascript:;" class="joinIn">加入亚富</a>
			</div>

	     	
	    </div>
	    <div class="mask hide" onclick="$('.mask').fadeOut();
		$('.chain').fadeOut()" style="background: rgba(0, 0, 0, 0.6);"></div>
		<div class="chain hide">
            <div class="chainBox">
                <div class="chainText">
                    <h1>请输入购买亚富能量</h1>
                    <h2>众筹期间时间和能量有限，抓住机会！</h2>
                    <div class="input flex-box">
                        <!-- <span class="cut"></span> -->
                        <input id="numinput" type="number" value="100">
                        <!-- <span class="add"></span> -->
                    </div>
                    <p class="flex-box pricemoney"><span class="price">{$recognize.price} </span>元/GB，共需花费 <span class="money">10</span> 元</p>
                </div>
                <div class="btn" id="buy_lido" data-place-url="/lido/place_buy_order.html">
                </div>
            </div>
		</div>
		
	
		<style>
			.lay_jieshao{
				position: fixed;
				top: 0;
				left: 0;
				height: 100%;
				width: 100%;
				background-color: #333;
				z-index: 6;
				display: none;
			}
			.lay_jieshao .intorBox{
				position: absolute;
				top: 20%;
				left: 50%;
				transform: translateX(-50%);
				width: 90%;
				background-color: #fff;
				font-size: .56rem;
				border-radius: .3rem;
				padding: .5rem;
				height: 60%;
				overflow-y:scroll;
			}
			
			.lay_jieshao .intorBox .close{
				position: absolute;
				right: .3rem;
				top: .3rem;
				width: .8rem;
				height: .8rem;
				background: url(__STATIC__/images/ico/guanbi.png) no-repeat center;
			}
			.lay_jieshao .intorBox img{
                display: block;
            }
            .lay_jieshao .intorBox p {
                line-height: 1rem;
                 
            }
            .lay_jieshao .intorBox p span{
                font-size: .56rem !important;
            }
           
		</style>
		<div class="lay_jieshao">
			<div class="intorBox">		
				<span class="close"></span>
				{$recognize.content|htmlspecialchars_decode}
			</div>
		</div>
		<style>
				.pwdBox{
					display: none;
				}
			
				.labelPwd{
					line-height: 2rem;
					font-size: .6rem;
				}
			
				.pwd {
					border: none;
					border-bottom: 1px solid #909090;
					outline: none;
					text-indent: .5rem;
				}
			
				.btnPwd {
					margin-top: 1rem;
					width: 40%;
					height: 1.5rem;
					border-radius: .2rem;
					background-color: #2A81F4;
					color: #fff;
					text-align: center;
					border: none;
					outline: none;
				}
			
				.btnCancel {
					width: 40%;
					height: 1.5rem;
					border-radius: .2rem;
					background-color: #b9b9b9;
					
					color: #fff;
					text-align: center;
					border: none;
					outline: none;
					margin-right: 1rem;
				}
			</style>
			<div class="pwdBox">
				<form action="" method="POST" class="showPwd">
					<label class="labelPwd">
						<input type="password" class="pwd" name="password" placeholder="请输入密码">
					</label>
					<div>
						<input type="button" class="btnCancel" value="取消">
						<input type="submit" class="btnPwd" value="确定">
					</div>
				</form>
			</div>
			<style>
				.lay_chong{
					position: fixed;
					top: 0;
					left: 0;
					height: 100%;
					width: 100%;
					background-color: #333;
					z-index: 8;
					display: none;
				}
				.lay_chong .chong_box{
					position: absolute;
					top: 20%;
					left: 50%;
					transform: translateX(-50%);
					width: 90%;
					background-color: #fff;
					font-size: .56rem;
					border-radius: .3rem;
					padding: 1.5rem .5rem;
					text-align: center;
				}
				.lay_chong .chong_box p{
					font-size: .56rem;
					color: #333;
					margin-bottom: 1rem;
					text-align: center;
				}
				.lay_chong .chong_box .btn_go{
					font-size: .5rem;
					background-color: #2A81F4;
					padding: .3rem ;
					width: 80%;
					color:#fff;
					border-radius: .3rem;
				}
				.lay_chong .chong_box .close{
					position: absolute;
					right: .3rem;
					top: .3rem;
					width: .8rem;
					height: .8rem;
					background: url(__STATIC__/images/ico/guanbi.png) no-repeat center;
				}
			</style>
			<div class="lay_chong">
				<div class="chong_box">
					<span class="close"></span>
					<p>对不起,您的余额不足,当前余额:{$user.user_money}</p>
					<a href="{:url('Mobile/User/recharge')}" style="background: #31addc;color: #fff;padding: 0.2rem 0.5rem;border-radius: 0.4rem;">立即充值</a>
				</div>
			</div>
	</div>
<script src="__STATIC__/js/style.js" type="text/javascript" charset="utf-8"></script>
<script type="text/javascript">
	var recognize_id = parseInt("{$recognize.id}");
	var limit_qty = parseInt("{$recognize['limit_qty']}");
	console.log(limit_qty);
	$(function(){
		var times = {$remainTime};
		cuntDown();
		timeDown();		
		
		
		// 立即够买
		var $price=$('.chainBox .price');
		var $numinput=$('#numinput');
		var $money=$('.chainBox .money');
		$money.html($price.html()*$numinput.val());
		$numinput.keyup(function (e) {
			console.log(e.keyCode);
			if($(this).val()>limit_qty){
				$(this).val(limit_qty)
			}
			$money.html($price.html()*$(this).val());
			
		})
		$numinput.keydown(function (e) {
			console.log(e.keyCode)
			if(e.keyCode>=48&&e.keyCode<=57 || e.keyCode>=96 && e.keyCode<=105 || e.keyCode==8 ){
				
			}else{
				return false;
			}
			
		})
		// 介绍
		$('.introduce.jieshao').click(function(){
			$('.lay_jieshao').show();
		})
		$('.lay_jieshao .close').click(function(){
			$('.lay_jieshao').hide();
		})
		$('.lay_jieshao').click(function () {
			$(this).hide();
		})
		$('.lay_chong .close').click(function(){
			$('.lay_chong').hide();
		})
		$('.lay_chong .btn_go').click(function(){
			
		})
		
		//恭喜轮播
		 var adtimer;
	     var wrap = $(".success ul");
	     var len = $(".success ul li").length;
	     if (len > 1) {
	        $(".success").hover(function () {
	                clearInterval(adtimer);
	            },
	            function () {
	                adtimer = setInterval(function () {
	                    var first = wrap.find("li:first");
	                    var HEIGHT = first.height();
	                    first.animate({
	                        marginTop: -HEIGHT + 'px'
	                    }, 500, function () {
	                        first.css('marginTop', 0).appendTo(wrap);
	                    })
	                }, 3000)
	            }).trigger('mouseleave');
	    }
	    //倒计时
		function timeDown() {
			var timer = null;
			timer = setInterval(cuntDown, 1000);
			if (times < 0) {
				clearInterval(timer)
			}
		}

		function cuntDown() {
			var day = 0, hour = 0, minute = 0, second = 0;
			if (times > 0) {
				day = Math.floor(times / (60 * 60 * 24));
				hour = Math.floor(times / (60 * 60)) - (day * 24);
				minute = Math.floor(times / 60) - (day * 24 * 60) - (hour * 60);
				second = Math.floor(times) - (day * 24 * 60 * 60) - (hour * 60 * 60) - (minute * 60);
			}
			if (day <= 9) {
				day = '0' + day;
			}
			if (hour <= 9) {
				hour = '0' + hour;
			}
			if (minute <= 9) {
				minute = '0' + minute;
			}
			if (second <= 9) {
				second = '0' + second;
			}
			$('.time').text(day + ' 天 ' + hour + ' 时 ' + minute + ' 分 ' + second + ' 秒');
			times--;
		}
	    
	    
	    //加入亚富按钮
	    $('.joinIn').click(function(){
	    	$('.chain').fadeIn();
			$('.mask').fadeIn();
	    });
		// 名单
		$('.introduce.mingdan').click(function () {		
			$('.lay_mingdan').show();
		})
		$('.lay_mingdan .close').click(function(){
			$('.lay_mingdan').hide();
		})
		$('.lay_mingdan').click(function(){
			$(this).hide();
		})

		//够买
		function checkPwdCode(trade_id, successCallback) {
			var layerIndex = layer.open({
				title: [
					'输入密码',
					'background-color: #2A81F4; color:#fff;font-size:.7rem;height:1.6rem;line-height:1.6rem;'
				],
				content: $('.showPwd').html(),
			});
			//确定按钮
			$(document).on('click', '.btnPwd', function () {
				var value = $('.layui-m-layer input[type=password]').val();
				$.ajax({
					url: '/Mobile/goldchain/validateSafePassword/',
					type: 'POST',
					data: {password: value},
					success: function (res) {
						if (res.code == 0) {
							alert(res.msg);
						} else {
							successCallback(trade_id, value);
							$(document).off('click', '.btnPwd');
						}
					}
				});
			})
			$(document).one('click', '.btnCancel', function () {
				$(document).off('click', '.btnPwd');
				layer.close(layerIndex)
			})
		}
		
		
		$('#buy_lido').click(function () {
			var numinput = $('#numinput').val();
			$.ajax({
				url: '/Mobile/Recognize/buy',
				type: 'POST',
				data: {numinput: numinput, recognize_id:recognize_id},
				success: function (res) {
					console.log(res);
					switch (res.code) {
						case -1:
							$('.mask,.chain').hide();
							$('.lay_chong').show();
							break;
						case 0:
							alert(res.msg);
							break;
						case -2:
							layer.open({
								content:res.msg,
								time:2,
								end:function(){
									window.location.href="{:U('Recognize/buyhistory')}"
								}
							})
							break;
						default:
							$('.mask,.chain').hide();
							layer.open({
								content:res.msg,
								time:2,
								end:function(){
									checkPwdCode(res.data.id, function (trade_id, password) {
										$.ajax({
											url: '/Mobile/Recognize/pay',
											type: 'POST',
											data: {
												trade_id: trade_id,
												password:password
											},
											success: function (datas) {
												console.log(datas)
												if (datas.code == 0) {
													showErrorMsg(datas.msg);
												} else {
													showErrorMsg(datas.msg, true);
												}
											}
										});
									});
								}
							})
							break;
							
					}
					
				}
			});
			return false;
		});
		function showErrorMsg(msg, reload) {
			layer.open({
				content: msg,
				time: 3,
				end: function () {
					if (reload) {
						$('.sell-box>p').eq(1).hasClass('sell-red') ? setCookies('stype', 1) : setCookies('stype', 0);
						window.location.reload();
					}
				}
			});
		}
	})
</script>
</body>
</html>
